<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVSS v3.1 Risk Calculator – Exploitability (Blue Team)</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <div class="container">
        <div class="header" id="mainHeader">
            <h1>CVSS v3.1 Risk Calculator – Exploitability (Blue Team)</h1>
            <p>Select base metrics to compute Exploitability. Full Base score is also computed from the same selections (optional). Hover buttons to see numeric constants.</p>
        </div>

        <div class="content">
            <div class="metrics-grid">
                <!-- Base Metrics (Exploitability) -->
                <div class="metric-section">
                    <h2>Base Metrics (Exploitability)</h2>
                    
                    <div class="metric-group">
                        <div class="metric-label">Attack Vector (AV)</div>
                        <div class="button-group">
                            <button class="metric-btn tooltip active" data-tooltip="0.85" data-metric="av" data-value="network">Network (N)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.62" data-metric="av" data-value="adjacent">Adjacent (A)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.55" data-metric="av" data-value="local">Local (L)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.20" data-metric="av" data-value="physical">Physical (P)</button>
                        </div>
                    </div>

                    <div class="metric-group">
                        <div class="metric-label">Attack Complexity (AC)</div>
                        <div class="button-group">
                            <button class="metric-btn tooltip active" data-tooltip="0.77" data-metric="ac" data-value="low">Low (L)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.44" data-metric="ac" data-value="high">High (H)</button>
                        </div>
                    </div>

                    <div class="metric-group">
                        <div class="metric-label">Privileges Required (PR)</div>
                        <div class="button-group">
                            <button class="metric-btn tooltip" data-tooltip="0.85" data-metric="pr" data-value="none">None (N)</button>
                            <button class="metric-btn tooltip active" data-tooltip="0.62/0.68" data-metric="pr" data-value="low">Low (L)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.27/0.50" data-metric="pr" data-value="high">High (H)</button>
                        </div>
                    </div>

                    <div class="metric-group">
                        <div class="metric-label">User Interaction (UI)</div>
                        <div class="button-group">
                            <button class="metric-btn tooltip active" data-tooltip="0.85" data-metric="ui" data-value="none">None (N)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.62" data-metric="ui" data-value="required">Required (R)</button>
                        </div>
                    </div>
                </div>

                <!-- Scope & Impact Metrics -->
                <div class="metric-section">
                    <h2>Scope & Impact Metrics (for full Base)</h2>
                    
                    <div class="metric-group">
                        <div class="metric-label">Scope (S)</div>
                        <div class="button-group">
                            <button class="metric-btn tooltip active" data-tooltip="Unchanged" data-metric="scope" data-value="unchanged">Unchanged (U)</button>
                            <button class="metric-btn tooltip" data-tooltip="Changed" data-metric="scope" data-value="changed">Changed (C)</button>
                        </div>
                    </div>

                    <div class="metric-group">
                        <div class="metric-label">Confidentiality (C)</div>
                        <div class="button-group">
                            <button class="metric-btn tooltip" data-tooltip="0.00" data-metric="conf" data-value="none">None (N)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.22" data-metric="conf" data-value="low">Low (L)</button>
                            <button class="metric-btn tooltip active" data-tooltip="0.56" data-metric="conf" data-value="high">High (H)</button>
                        </div>
                    </div>

                    <div class="metric-group">
                        <div class="metric-label">Integrity (I)</div>
                        <div class="button-group">
                            <button class="metric-btn tooltip active" data-tooltip="0.00" data-metric="integ" data-value="none">None (N)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.22" data-metric="integ" data-value="low">Low (L)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.56" data-metric="integ" data-value="high">High (H)</button>
                        </div>
                    </div>

                    <div class="metric-group">
                        <div class="metric-label">Availability (A)</div>
                        <div class="button-group">
                            <button class="metric-btn tooltip active" data-tooltip="0.00" data-metric="avail" data-value="none">None (N)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.22" data-metric="avail" data-value="low">Low (L)</button>
                            <button class="metric-btn tooltip" data-tooltip="0.56" data-metric="avail" data-value="high">High (H)</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="results-grid">
                <div class="result-card" id="exploitabilityCard">
                    <div class="result-title">Exploitability</div>
                    <div class="result-score" id="exploitabilityScore">2.84</div>
                    <div class="result-formula">8.22 × AV × AC × PR × UI</div>
                </div>
                
                <div class="result-card" id="impactCard">
                    <div class="result-title">Impact (optional)</div>
                    <div class="result-score" id="impactScore">3.60</div>
                    <div class="result-formula">ISS = 1 - (1-C)(1-I)(1-A)</div>
                </div>
                
                <div class="result-card" id="baseCard">
                    <div class="result-title">Base Score (optional)</div>
                    <div class="result-score" id="baseScore">6.5</div>
                    <div class="result-formula">Rounded up to 1 decimal</div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="action-btn btn-primary" id="mysqlBtn">Load MySQL Scenario</button>
                <button class="action-btn btn-secondary" id="nvdBtn">NVD CVSS v3.1 Reference</button>
            </div>

            <div class="notes">
                <strong>Notes:</strong> For PR, constants differ by Scope: Low = 0.62 (U) / 0.68 (C); High = 0.27 (U) / 0.50 (C). Rounding follows CVSS "round up" rule (ceil to 1 decimal). Colors indicate severity: Red (Critical: 9.0-10.0), Orange (High: 7.0-8.9), Yellow (Medium: 4.0-6.9), Green (Low: 0.1-3.9), Gray (None: 0.0).
            </div>
        </div>
    </div>

    <!-- Modal for MySQL Scenario -->
    <div id="mysqlModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeBtn">&times;</span>
            <h2>MySQL Server SQL Injection Vulnerability</h2>
            <div class="mysql-scenario">
                <p><strong>Scenario:</strong> A vulnerability in the MySQL Server database could allow a remote, authenticated user to inject SQL code that runs with user privileges on a remote MySQL Server database. A successful attack could allow any data in the remote MySQL database to be read only (not modified). The vulnerability occurs due to insufficient validation of user-supplied data but it is not replicated to remote MySQL Server instances.</p>
            </div>
            <p><strong>Recommended CVSS Settings:</strong></p>
            <ul>
                <li><strong>Attack Vector:</strong> Network (N) - Remote attack</li>
                <li><strong>Attack Complexity:</strong> Low (L) - Easy to exploit</li>
                <li><strong>Privileges Required:</strong> Low (L) - Requires authentication</li>
                <li><strong>User Interaction:</strong> None (N) - No user interaction needed</li>
                <li><strong>Scope:</strong> Unchanged (U) - Same security authority</li>
                <li><strong>Confidentiality:</strong> High (H) - All data can be read</li>
                <li><strong>Integrity:</strong> None (N) - Cannot modify data</li>
                <li><strong>Availability:</strong> None (N) - No impact on availability</li>
            </ul>
            <button class="action-btn btn-primary" id="applyBtn">Apply These Settings</button>
        </div>
    </div>

    <script src="./script.js"></script>
</body>
</html>

